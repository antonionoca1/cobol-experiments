IDENTIFICATION DIVISION.
PROGRAM-ID. PRINT-NAMES.
ENVIRONMENT DIVISION.
INPUT-OUTPUT SECTION.
FILE-CONTROL.
    SELECT CSV-FILE ASSIGN TO "sample.csv"
        ORGANIZATION IS LINE SEQUENTIAL.
DATA DIVISION.
FILE SECTION.
FD  CSV-FILE.
01  CSV-RECORD        PIC X(80).
WORKING-STORAGE SECTION.
01  WS-FIRST-NAME     PIC X(20).
01  WS-SURNAME        PIC X(20).
01  WS-TAB-POS1       PIC 9(2) VALUE 0.
01  WS-TAB-POS2       PIC 9(2) VALUE 0.
01  WS-LINE-LEN       PIC 9(2) VALUE 0.
01  WS-I              PIC 9(2) VALUE 0.
01  WS-CHAR           PIC X(1).
01  WS-FIRST-LEN      PIC 9(2) VALUE 0.
01  WS-SURNAME-LEN    PIC 9(2) VALUE 0.
01  WS-SURNAME-START  PIC 9(2) VALUE 0.
01  EOF-FLAG          PIC X VALUE 'N'.
    88  EOF-REACHED   VALUE 'Y'.
    88  NOT-EOF       VALUE 'N'.
PROCEDURE DIVISION.
    OPEN INPUT CSV-FILE.
    PERFORM UNTIL EOF-REACHED
        READ CSV-FILE
            AT END
                SET EOF-REACHED TO TRUE
            NOT AT END
                PERFORM EXTRACT-NAMES
        END-READ
    END-PERFORM
    CLOSE CSV-FILE.
    STOP RUN.
EXTRACT-NAMES.
    MOVE 0 TO WS-TAB-POS1 WS-TAB-POS2 WS-LINE-LEN WS-I.
    MOVE SPACE TO WS-FIRST-NAME WS-SURNAME.
    INSPECT CSV-RECORD TALLYING WS-LINE-LEN FOR CHARACTERS.
    PERFORM VARYING WS-I FROM 1 BY 1 UNTIL WS-I > WS-LINE-LEN
        MOVE CSV-RECORD(WS-I:1) TO WS-CHAR
        IF WS-CHAR = X'09' AND WS-TAB-POS1 = 0
            MOVE WS-I TO WS-TAB-POS1
        ELSE IF WS-CHAR = X'09' AND WS-TAB-POS1 > 0 AND WS-TAB-POS2 = 0
            MOVE WS-I TO WS-TAB-POS2
        END-IF
    END-PERFORM
    IF WS-TAB-POS1 > 1
        COMPUTE WS-FIRST-LEN = WS-TAB-POS1 - 1
        MOVE CSV-RECORD(1:WS-FIRST-LEN) TO WS-FIRST-NAME
    END-IF
    IF WS-TAB-POS2 > WS-TAB-POS1 + 1
        COMPUTE WS-SURNAME-START = WS-TAB-POS1 + 1
        COMPUTE WS-SURNAME-LEN = WS-TAB-POS2 - WS-TAB-POS1 - 1
        MOVE CSV-RECORD(WS-SURNAME-START:WS-SURNAME-LEN) TO WS-SURNAME
    END-IF
    DISPLAY WS-FIRST-NAME " " WS-SURNAME.